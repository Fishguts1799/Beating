<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Beating Visualization — Two Close Frequencies</title>
  <style>
    :root{
      --bg:#ffffff; --panel:#ffffff; --ink:#000000; --sub:#000000; --accent:#5ac8fa; --accent2:#ff9f43; --sum:#34c759;
      --grid:#2a2e34; --border:#ffffff;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--ink);font:14px/1.4 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    header{padding:12px 16px;border-bottom:1px solid var(--border);display:flex;gap:16px;flex-wrap:wrap;align-items:center}
    header h1{font-size:16px;margin:0;color:var(--ink);font-weight:600}
    .wrap{display:grid;grid-template-columns:1fr 320px;gap:14px;padding:14px;max-width:1200px;margin:0 auto}
    .panel{background:var(--panel);border:1px solid var(--border);border-radius:14px;overflow:hidden}
    .plots{display:grid;grid-template-rows:1fr 1fr;gap:8px}
    .canvas-wrap{position:relative;padding:8px 8px 18px 8px}
    canvas{display:block;width:100%;height:300px;background:#ffffff;border-radius:10px}
    .caption{position:absolute;left:16px;bottom:4px;color:var(--sub);font-size:12px}

    .controls{
      padding:12px;
      display:grid;
      gap:8px;                 /* adjust to taste */
      align-content:start;     /* pack groups at the top */
      align-items:start;       /* don't stretch items */
      grid-auto-rows:max-content; /* rows size to their content */
      }
    .group{border:1px solid var(--border);padding:10px;border-radius:10px}
    .group h3{margin:0 0 8px 0;font-size:20px;color:var(--sub);font-weight:600}
    .row{display:grid;grid-template-columns:1fr 90px;gap:8px;align-items:center;margin:6px 0}
    .row label{color:var(--ink)}
    input[type="range"]{width:100%}
    input[type="number"]{width:100%;padding:6px 8px;background:#ffffff;border:1px solid var(--border);color:var(--ink);border-radius:8px}
    .checks{display:flex;flex-wrap:wrap;gap:10px}
    .checks label{display:flex;gap:6px;align-items:center;color:var(--sub)}
    .btns{display:flex;gap:8px}
    button{cursor:pointer;background:#ffffff;border:1px solid var(--border);color:var(--ink);padding:8px 10px;border-radius:10px}
    button.primary{background:var(--sum);border-color:transparent;color:#ffffff;font-weight:600}
    .info{display:flex;justify-content:space-between;color:var(--sub);font-size:20px}
    footer {
  text-align:left;
  color: var(--sub);
  font-size: 13px;
  padding: 14px 14px;
  border-top: 1px solid var(--border);
  margin-top: 0px;
}

    @media (max-width: 980px){
      .wrap{grid-template-columns:1fr}
      canvas{height:200px}
    }
  </style>
</head>
<body>
  <header>
  <img src="RedWolfLogo.png" alt="Red Wolf Reliability Logo" class="logo">
  <h1>Beating Visualization — Two Close Frequencies</h1>
  <div class="info" style="gap:20px">
    <div id="beatLabel">Beat: —</div>
    <div id="timeLabel">t = 0.000 s</div>
  </div>
</header>
  <main class="wrap">
    <section class="panel plots" aria-label="Plots">
      <div class="canvas-wrap">
        <canvas id="canvasTop" width="1200" height="300"></canvas>
       </div>
      <div class="canvas-wrap">
        <canvas id="canvasSum" width="1200" height="300"></canvas>
      </div>
    </section>

    <aside class="panel controls" aria-label="Controls">
      <div class="group">
        <h3>Frequencies (Hz)</h3>
        <div class="row"><label for="f1">f₁</label><input id="f1Num" type="number" step="0.01" min="0.05" max="40"></div>
        <input id="f1" type="range" min="0.05" max="40" step="0.01">
        <div class="row"><label for="f2">f₂</label><input id="f2Num" type="number" step="0.01" min="0.05" max="40"></div>
        <input id="f2" type="range" min="0.05" max="40" step="0.01">
      </div>

      <div class="group">
        <h3>Amplitudes & Phase</h3>
        <div class="row"><label for="a1">A₁</label><input id="a1Num" type="number" step="0.01" min="0" max="5"></div>
        <input id="a1" type="range" min="0" max="5" step="0.01">
        <div class="row"><label for="a2">A₂</label><input id="a2Num" type="number" step="0.01" min="0" max="5"></div>
        <input id="a2" type="range" min="0" max="5" step="0.01">
        <div class="row"><label for="p1">ϕ₁ (deg)</label><input id="p1Num" type="number" step="1" min="-360" max="360"></div>
        <input id="p1" type="range" min="-360" max="360" step="1">
        <div class="row"><label for="p2">ϕ₂ (deg)</label><input id="p2Num" type="number" step="1" min="-360" max="360"></div>
        <input id="p2" type="range" min="-360" max="360" step="1">
      </div>

      <div class="group">
        <h3>Display</h3>
        <div class="row"><label for="window">Window (s)</label><input id="windowNum" type="number" step="0.1" min="0.2" max="12"></div>
        <input id="window" type="range" min="0.2" max="12" step="0.1">
        <div class="row"><label for="scrollSpeed">Scroll speed (×)</label><input id="scrollSpeedNum" type="number" step="0.1" min="0" max="5"></div>
        <input id="scrollSpeed" type="range" min="0" max="5" step="0.1">
        <div class="checks">
          <label><input id="showS1" type="checkbox" checked> Show s₁</label>
          <label><input id="showS2" type="checkbox" checked> Show s₂</label>
          <label><input id="grid" type="checkbox" checked> Grid</label>
          <label><input id="scroll" type="checkbox" checked> Scroll</label>
        </div>
      </div>

      <div class="group">
        <h3>Playback</h3>
        <div class="btns">
          <button id="play" class="primary">Pause</button>
          <button id="reset">Reset</button>
        </div>
      </div>
    </aside>
  </main>

  <script>
  // -- Helpers ---------------------------------------------------------------
  const $ = sel => document.querySelector(sel);
  function linkRangeAndNumber(range, number, init){
    range.value = init; number.value = init;
    range.addEventListener('input', ()=>{ number.value = range.value; onChange(); });
    number.addEventListener('input', ()=>{ range.value = number.value; onChange(); });
  }
  function resizeForDPR(canvas){
    const dpr = Math.max(1, window.devicePixelRatio || 1);
    const r = canvas.getBoundingClientRect();
    canvas.width = Math.round(r.width * dpr);
    canvas.height = Math.round(r.height * dpr);
    const ctx = canvas.getContext('2d');
    ctx.setTransform(dpr,0,0,dpr,0,0);
    return ctx;
  }

  // -- DOM -------------------------------------------------------------------
  const canvTop = $('#canvasTop');
  const canvSum = $('#canvasSum');
  let ctxTop = resizeForDPR(canvTop);
  let ctxSum = resizeForDPR(canvSum);
  window.addEventListener('resize', ()=>{ ctxTop = resizeForDPR(canvTop); ctxSum = resizeForDPR(canvSum); });

  const f1R = $('#f1'), f1N = $('#f1Num');
  const f2R = $('#f2'), f2N = $('#f2Num');
  const a1R = $('#a1'), a1N = $('#a1Num');
  const a2R = $('#a2'), a2N = $('#a2Num');
  const p1R = $('#p1'), p1N = $('#p1Num');
  const p2R = $('#p2'), p2N = $('#p2Num');
  const winR = $('#window'), winN = $('#windowNum');
  const spdR = $('#scrollSpeed'), spdN = $('#scrollSpeedNum');
  const showS1 = $('#showS1');
  const showS2 = $('#showS2');
  const grid = $('#grid');
  const scroll = $('#scroll');
  const playBtn = $('#play');
  const resetBtn = $('#reset');
  const beatLabel = $('#beatLabel');
  const timeLabel = $('#timeLabel');

  // initial values
  linkRangeAndNumber(f1R, f1N, 1.00);
  linkRangeAndNumber(f2R, f2N, 1.20);
  linkRangeAndNumber(a1R, a1N, 1.00);
  linkRangeAndNumber(a2R, a2N, 1.00);
  linkRangeAndNumber(p1R, p1N, 0);
  linkRangeAndNumber(p2R, p2N, 0);
  linkRangeAndNumber(winR, winN, 3.0);
  linkRangeAndNumber(spdR, spdN, 1.0);

  [showS1,showS2,grid,scroll].forEach(el=> el.addEventListener('change', onChange));

  // -- Simulation state ------------------------------------------------------
  let playing = true;
  let t0 = 0;            // left-edge time of the visible window
  let lastTs = performance.now();

  playBtn.addEventListener('click', ()=>{
    playing = !playing;
    playBtn.textContent = playing ? 'Pause' : 'Play';
  });
  resetBtn.addEventListener('click', ()=>{ t0 = 0; onChange(); });

  function onChange(){
    const f1 = parseFloat(f1R.value), f2 = parseFloat(f2R.value);
    const beat = Math.abs(f2 - f1);
    beatLabel.textContent = `Beat: |f₂−f₁| = ${beat.toFixed(3)} Hz`;
  }

  // -- Drawing ---------------------------------------------------------------
  function drawPanel(ctx, w, h, opts){
    const left = 52, right = w-10, top = 10, bottom = h-24; // extra left room for y-axis labels
    const width = Math.max(1, right-left), height = Math.max(1, bottom-top);

    // background
    ctx.fillStyle = '#0f1114';
    ctx.fillRect(0,0,w,h);

    // compute signals and scale
    const f1 = parseFloat(f1R.value), f2 = parseFloat(f2R.value);
    const A1 = parseFloat(a1R.value), A2 = parseFloat(a2R.value);
    const p1 = Math.PI * parseFloat(p1R.value) / 180, p2 = Math.PI * parseFloat(p2R.value) / 180;
    const windowS = parseFloat(winR.value);

    const maxAmp = opts.drawSum ? Math.max(1e-6, A1 + A2) : Math.max(1e-6, Math.max(A1, A2));
    const yScale = 0.45 * height / maxAmp; // symmetric about midline

    // grid
    if(opts.grid){
      ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--grid');
      ctx.lineWidth = 1;
      ctx.beginPath();
      const hLines = 6, vLines = 10;
      for(let i=0;i<=hLines;i++){ const y = top + i*height/hLines; ctx.moveTo(left,y); ctx.lineTo(right,y);} 
      for(let i=0;i<=vLines;i++){ const x = left + i*width/vLines; ctx.moveTo(x,top); ctx.lineTo(x,bottom);} 
      ctx.stroke();
    }

    // axes
    const midY = top + height/2;
    ctx.strokeStyle = '#2a2e34';
    ctx.lineWidth = 1.2;
    // x-axis (midline)
    ctx.beginPath(); ctx.moveTo(left, midY); ctx.lineTo(right, midY); ctx.stroke();
    // y-axis
    ctx.beginPath(); ctx.moveTo(left, top); ctx.lineTo(left, bottom); ctx.stroke();

    // y ticks & labels in amplitude units
    ctx.fillStyle = '#9aa4b2';
    ctx.textAlign = 'right';
    ctx.textBaseline = 'middle';
    const yTicks = 4; // shows -max, -max/2, 0, +max/2, +max
    for(let i=0;i<=yTicks;i++){
      const frac = i / yTicks; // 0..1
      const amp = (1 - 2*frac) * maxAmp; // maps 0..1 to +max..-max
      const y = midY - amp * yScale;
      ctx.strokeStyle = '#2a2e34'; ctx.lineWidth = 1; ctx.beginPath(); ctx.moveTo(left-4,y); ctx.lineTo(left,y); ctx.stroke();
      const label = amp.toFixed(2);
      ctx.fillText(label, left - 6, y);
    }

    // sample points
    const N = Math.max(2, Math.floor(width));
    const pts1 = [], pts2 = [], ptsSum = [];
    for(let i=0;i<N;i++){
      const tau = (i/(N-1))*windowS;   // seconds from left edge
      const t = t0 + tau;
      const s1 = A1*Math.sin(2*Math.PI*f1*t + p1);
      const s2 = A2*Math.sin(2*Math.PI*f2*t + p2);
      const s = s1 + s2;
      const x = left + i*(width-1)/(N-1);
      pts1.push({x, y: midY - s1*yScale});
      pts2.push({x, y: midY - s2*yScale});
      ptsSum.push({x, y: midY - s*yScale});
    }

    // draw signals
    function strokeLine(points, color, width=2, dash=null){
      if(points.length<2) return;
      if(dash){ ctx.setLineDash(dash); } else { ctx.setLineDash([]); }
      ctx.strokeStyle = color; ctx.lineWidth = width; ctx.beginPath();
      ctx.moveTo(points[0].x, points[0].y);
      for(let i=1;i<points.length;i++){ ctx.lineTo(points[i].x, points[i].y); }
      ctx.stroke();
    }

    if(opts.drawSum){
      strokeLine(ptsSum, getComputedStyle(document.documentElement).getPropertyValue('--sum'), 2.4);
      // Envelope when A1≈A2
      if(Math.abs(A1-A2) < 1e-6){
        const envTop=[], envBot=[]; const M=200, df=Math.abs(f2-f1);
        for(let i=0;i<M;i++){
          const tau = (i/(M-1))*windowS; const t = t0 + tau; const env = Math.abs(2*A1*Math.cos(Math.PI*df*t));
          const x = left + i*(width-1)/(M-1);
          envTop.push({x, y: midY - env*yScale});
          envBot.push({x, y: midY + env*yScale});
        }
        strokeLine(envTop, '#9aa4b2', 1.4, [6,6]);
        strokeLine(envBot, '#9aa4b2', 1.4, [6,6]);
      }
    } else {
      if(showS1.checked) strokeLine(pts1, getComputedStyle(document.documentElement).getPropertyValue('--accent'), 2);
      if(showS2.checked) strokeLine(pts2, getComputedStyle(document.documentElement).getPropertyValue('--accent2'), 2);
    }

    // x-axis time ticks & labels
    ctx.strokeStyle = '#2a2e34'; ctx.fillStyle = '#9aa4b2'; ctx.lineWidth = 1; ctx.textAlign='center'; ctx.textBaseline='top';
    const ticks = 6; for(let i=0;i<=ticks;i++){
      const x = left + i*width/ticks; ctx.beginPath(); ctx.moveTo(x, bottom); ctx.lineTo(x, bottom+4); ctx.stroke();
      const tMark = t0 + i*windowS/ticks; ctx.fillText(`${tMark.toFixed(2)}s`, x, bottom+6);
    }

    // caption text (already in DOM)
  }

  function render(ts){
    const dt = (ts - lastTs) / 1000; lastTs = ts;
    if(playing && scroll.checked){ const spd = parseFloat(spdR.value); t0 += dt * spd; }
    timeLabel.textContent = `t = ${t0.toFixed(3)} s`;

    drawPanel(ctxTop, canvTop.clientWidth, canvTop.clientHeight, { drawSum:false, grid:grid.checked });
    drawPanel(ctxSum, canvSum.clientWidth, canvSum.clientHeight, { drawSum:true, grid:grid.checked });

    requestAnimationFrame(render);
  }

  onChange();
  requestAnimationFrame(ts=>{ lastTs = ts; requestAnimationFrame(render); });
  </script>
  <footer>
  © 2025 Red Wolf Reliability — All Rights Reserved.
</footer>
</body>
</html>
